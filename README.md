## Цель работы

Научиться пользоваться Ansible Galaxy и писать роли

## **Ход работы**

1. Инициировать структуру роли “**Docker**” через Ansible-Galaxy
2. Вынести из предыдущего плейбука задачи установки Docker в отдельную роль
3. Параметризовать роль через переменные
4. Создать в gitlab группу для репозиториев с ролями, запушить роль “**Docker**” в репозиторий
5. Создать файл requirements.yml для установки роли Docker из репозитория
6. Запустить приложение на нодах группы [app] используя ansible-playbook с ролью “**Docker**”

Домашняя директория `Ansible` содержит в себе файл `ansible.cfg`, в котором определяются общие настройки для ansible, файл `host` для определения ip серверов, которые 
будут управлятся с помощью ansible, файл `playbook.yml` для определения набора задач, которые необходимо выполнить для автоматизации и развертывания приложения или конфигурации
серверов, файл `requirements.yml` для определения списка ролей, которые должны быть загружены в проект с удаленного репозитория, директория `roles` для хранения ролей и директория
`group_vars`, которая содержит переменные для групп серверов, которые можно в будущем переопределить:

![image](https://github.com/user-attachments/assets/9a5391a5-daa1-4960-ade0-b7e97c4b5a92)

1. Инициировать структуру роли “**Docker**” через Ansible-Galaxy
При помощи команды инициализируем новую роль Docker в директории `/roles`:
```
ansible-galaxy init Docker
```

![image](https://github.com/user-attachments/assets/1c09b277-8b0f-46e8-ba49-94b44412b188)

2. Вынести из предыдущего плейбука задачи установки Docker в отдельную роль

В директории `roles/docker/tasks` добавим в `main.yml` задачи из предыдущего плейбука:

![image](https://github.com/user-attachments/assets/f9387439-8b5d-4b91-b682-f65291e9f1c8)

3. Параметризовать роль через переменные

В директории `roles/docker/defaults/` в файл `main.yml` добавим переменные по умолчанию:

![image](https://github.com/user-attachments/assets/d29afc51-a325-4c4c-bc09-8ed786018348)

Эти переменные будут использованы в плейбуке для роли docker.

4. Создать в gitlab группу для репозиториев с ролями, запушить роль “**Docker**” в репозиторий
   
На github создали директорию с ролями, а также в основном плейбуке добавили нашу роль docker в файле `playbook.yml`:

![image](https://github.com/user-attachments/assets/8984b25b-c9e0-4411-85cd-7089c624df88)

5. Создать файл requirements.yml для установки роли Docker из репозитория

В домашней директории создаем файл `requirements.yml`, в котором определим список ролей, которые будут загружены в проект с удаленного репозитория:

![image](https://github.com/user-attachments/assets/2493bf81-db78-47e9-acb5-6838d02766a8)


6. Запустить приложение на нодах группы [app] используя ansible-playbook с ролью “**Docker**”







